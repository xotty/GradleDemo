def username="John"
ext.age=20

task showPersonInfo1(group:"demo"){
    def isMale=true
    ext.city="Shanghai"
    doLast{
        def job="worker"
        ext.company="CCTV"
        println "Task Action1:     name=$username     age=$age"
        println "Task Action1:     isMale=$isMale  city=$city"
        println "Task Action1:     Job=$job  company=$company"
    }
    doLast{
        println "Task Action2:     name=$username     age=$age"
        println "Task Action2:     isMale=$isMale  city=$city"
        println "Task Action2:     company=$company"
        //wrong: println "Job=$job "
    }
}

task showPersonInfo2(group:"demo"){
    doLast{
        println "Another Task:     username=$username     age=$age"
        println "Another Task:     city=$showPersonInfo1.city"
        //wrong:println "isMale=$isMale  city=$city"
        //wrong:println "Job=$job  company=$company"
    }
}

//打印定义在gradle.properties中的属性
task showPropertyInfo(group:"demo"){
    doLast{
        //自定义属性
        println '-------------自定义属性-----------------'
        println "studentName=${studentName}    studentScore=${project.property('studentScore')}"
        println project.property("org.gradle.project.coo")

        //系统属性
        println '-------------系统属性-----------------'
        println System.getProperty('os.name')
        println System.getProperty('abc')
        println System.properties['custom']
        println System.getProperty('gradle.wrapperUser')

        //OS环境变量
        println '-------------OS环境变量-----------------'
        println System.getenv('JAVA_HOME')
        println System.getenv('GRADLE_USER_HOME')

        //Gradle环境变量
        println '-------------Gradle环境变量-----------------'
        println project.property("org.gradle.daemon")
    }
}
println "name=$username     age=$age"

class Greetings extends DefaultTask {
    @TaskAction
    void myAction1(){
        //wrong println $project.username
        println "Class:     age=$project.age"
        println "Class:     studentName=${project.studentName}    studentScore=$project.studentScore"
        println "Class:     $project.configurations.song"
    }
    @TaskAction
    def myAction2(){
        println "Class:     age = ${project.age}!"
        println "Class:     city = ${project.showPersonInfo1.city}"
        //wrong:println "Hi ${project.showPersonInfo1.company}"
    }
}

def add(int x,int y){
    //println "name=$username"    局部变量在方法中不可见
    println "Gradle Method:     age=$age"
    x+y
}

def closure = {
    //局部变量在闭包中可见
    println "Closure:     name=$username     age=$age"
}

task mTask(type:Greetings,group:"demo"){
    doLast {
        closure.call()
        println "Enhanced Task:     ${add(3, 5)}"
        println "Enhanced Task:     $configurations.song"
    }
}

configurations{
    ext.song="Gong wWth Wind"
    println "Script Block:     name=$username     age=$age"
}
